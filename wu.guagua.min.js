/**

by wushufen
2014.11.25
wusfun@foxmail.com

*/
+function(a){a.guagua=function(a){var b=a.el,c=a.cover,d=a.callback,e=b.clientWidth,f=b.clientHeight,g=document.createElement("canvas");g.width=e,g.height=f,b.style.position="relative",g.style.position="absolute",g.style.left="0",g.style.top="0",b.appendChild(g);var h=g.getContext("2d");if(h.fillStyle="#A3A3A3",h.fillRect(0,0,e,f),c){var i=new Image;i.src=c,i.onload=function(){h.drawImage(i,0,0)}}var j=function(a){a.preventDefault(),h.globalCompositeOperation="destination-out",a.changedTouches&&(a=a.changedTouches[a.changedTouches.length-1]);var c=(a.clientX+document.body.scrollLeft||a.pageX)-b.offsetLeft||0,e=(a.clientY+document.body.scrollTop||a.pageY)-b.offsetTop||0;h.arc(c,e,15,0,2*Math.PI),h.fill(),d&&d(k())},k=function(){for(var a=h.getImageData(0,0,e,f),b=a.data,c=[],d=0,g=b.length;g>d;d+=4){var i=b[d+3];128>i&&c.push(d)}return(100*(c.length/(b.length/4))).toFixed(2)};return g.addEventListener("touchmove",j),g.addEventListener("mousemove",j),{ctx:h}},window.wu=a}(window.wu||{});